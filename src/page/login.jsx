import React, { Component } from 'react';import { Form, Input, Checkbox, Button, Message } from 'element-react';import { $fetch } from "../common";import '../assets/css/login.css';class Login extends Component {	constructor ( props ) {		super( props );		this.state = {			data: {				username: '',				password: ''			}		};		this.rules = {			username: [				{ required: true, message: '请输入帐号', trigger: 'blur' },				{					validator: ( rule, value, callback ) => {						let reg = /^[a-zA-z]\w{3,15}$/;						if ( !reg.test( value ) ) {							callback( new Error( '字母、数字、下划线组成，字母开头，4-16位' ) );						} else {							callback();						}					}				}			],			password: [				{ required: true, message: '请输入密码', trigger: 'blur' },				{					validator: ( rule, value, callback ) => {						let reg = /(?=.*[0-9])(?=.*[a-zA-Z])(?=.*[^a-zA-Z0-9]).{7,29}$/;						if ( !reg.test( value ) ) {							callback( new Error( '字母、数字、特殊字符组成，8-30位' ) );						} else {							callback();						}					}				}			]		};		this.isClick = true;	}	handleLogin () {		this.refs.form.validate( ( valid ) => {			if ( valid ) {				if ( !this.isClick ) {					Message( {						message: '请勿重复点击',						type: 'warning'					} );					return false;				}				this.isClick = false;				const { data } = this.state;				$fetch( '/play/login', 'POST', data, data => {					if ( data.status === 0 ) {						localStorage.setItem( "token", data.data );						this.props.history.push( '/' );					} else {						Message( {							message: data.msg,							type: 'error'						} );					}					this.isClick = true;				} );			} else {				return false;			}		} );	}	handleChange ( key, value ) {		this.setState( {			data: Object.assign( {}, this.state.data, { [ key ]: value } )		} );	}	render () {		const { data } = this.state;		return (			<div className='login'>				<div className='login-body'>					<div className='login-header'>					</div>					<div className='login-main'>						<Form ref='form' model={ data } rules={ this.rules }>							<Form.Item prop='username'>								<Input									className='username'									placeholder="帐号"									value={ data.username }									onChange={ this.handleChange.bind( this, 'username' ) }								/>							</Form.Item>							<Form.Item prop='password'>								<Input									className='password'									type='password'									placeholder="密码"									value={ data.password }									onChange={ this.handleChange.bind( this, 'password' ) }								/>							</Form.Item>							<Form.Item>								<Checkbox>记住密码</Checkbox>								<Button className="login-register" type="text">注册</Button>							</Form.Item>							<Form.Item>								<Button									className="login-button"									type="primary"									onClick={ this.handleLogin.bind( this ) }								>登录</Button>							</Form.Item>						</Form>					</div>					<div className='login-footer'>					</div>				</div>			</div>		)	}}export default Login;